import fs from 'fs'
import {spawn} from 'child_process'

class NeuralDataService {
  getNeuralData(req) {
    return new Promise((res, rej) => {
      res(
        [
            {
                "date": 1514365200000,
                "OT": 0.13093542916214632
            },
            {
                "date": 1514368800000,
                "OT": 0.14000125600530952
            },
            {
                "date": 1514372400000,
                "OT": 0.14549476096591385
            },
            {
                "date": 1514376000000,
                "OT": 0.14984322096898184
            },
            {
                "date": 1514379600000,
                "OT": 0.15634493541307162
            },
            {
                "date": 1514383200000,
                "OT": 0.164818109649001
            },
            {
                "date": 1514386800000,
                "OT": 0.1702090620547152
            },
            {
                "date": 1514390400000,
                "OT": 0.17351426557743083
            },
            {
                "date": 1514394000000,
                "OT": 0.17653833406965938
            },
            {
                "date": 1514397600000,
                "OT": 0.17482790119767272
            },
            {
                "date": 1514401200000,
                "OT": 0.17572939432205553
            },
            {
                "date": 1514404800000,
                "OT": 0.17598547897780342
            },
            {
                "date": 1514408400000,
                "OT": 0.174900711696271
            },
            {
                "date": 1514412000000,
                "OT": 0.1725548179464092
            },
            {
                "date": 1514415600000,
                "OT": 0.17396330909523855
            },
            {
                "date": 1514419200000,
                "OT": 0.16947600862060802
            },
            {
                "date": 1514422800000,
                "OT": 0.16661824003834802
            },
            {
                "date": 1514426400000,
                "OT": 0.16343939746562092
            },
            {
                "date": 1514430000000,
                "OT": 0.16728702214137434
            },
            {
                "date": 1514433600000,
                "OT": 0.1705506461780253
            },
            {
                "date": 1514437200000,
                "OT": 0.16265955173732993
            },
            {
                "date": 1514440800000,
                "OT": 0.16941314012262287
            },
            {
                "date": 1514444400000,
                "OT": 0.16805728831004801
            },
            {
                "date": 1514448000000,
                "OT": 0.1770632302008306
            },
            {
                "date": 1514451600000,
                "OT": 0.17164013396868377
            },
            {
                "date": 1514455200000,
                "OT": 0.17368229847746863
            },
            {
                "date": 1514458800000,
                "OT": 0.18102846515214382
            },
            {
                "date": 1514462400000,
                "OT": 0.19019430076748273
            },
            {
                "date": 1514466000000,
                "OT": 0.1912254902821678
            },
            {
                "date": 1514469600000,
                "OT": 0.19250685572376194
            },
            {
                "date": 1514473200000,
                "OT": 0.1960515426717686
            }
        ]
    );
        const pyProg = spawn('C:\\Users\\Python\\Python311\\python.exe',
        ['.\\src\\python-scripts\\predict.py', req.query.n]);

        let i = 0
        pyProg.stdout.on('data', function(data) {

          i++
          if (i === 5)
            res(JSON.parse(data.toString()));
        });
        pyProg.stderr.on('data', (data) => {
          console.log('stderr:', data.toString().length, 'chars');
          // rej(data.toString());
        });

    })
  }
}

const neuralDataService: NeuralDataService = new NeuralDataService()

export default neuralDataService